video-player {
  display: block;
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  position: relative;
  height: 100%;
  aspect-ratio: 16/9;
  /* Default for non-responsive */
  background-color: #000;
  /* Darker background to hide potential artifacts */
  contain: content;
  /* CSS containment to improve performance */
  transform: translateZ(0);
  /* Force GPU acceleration */
  backface-visibility: hidden;
  /* Prevent flickering */
}

/* Responsive mode settings */
video-player.responsive {
  aspect-ratio: 9/16;
  /* Mobile first for responsive mode */
}

@media screen and (min-width: 48rem) {
  video-player.responsive {
    aspect-ratio: 16/9;
    /* Desktop for responsive mode */
  }
}

.video-player__background {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  transform: translate(-50%, -50%) scale(1);
  /* Reduced scale for better performance */
  transform-origin: center center;
  pointer-events: none;
  opacity: 1;
  /* Always visible */
  z-index: 1; /* Lower z-index so overlay can appear above */
  transform-style: flat;
  backface-visibility: hidden;
  will-change: transform; /* Optimize transform performance */
  /* Fix for videos showing incorrectly positioned */
  object-fit: cover;
  object-position: center center;
}

/* Add this wrapper to fix inconsistent iframe positioning */
.video-player__background-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: 1; /* Lower z-index so overlay can appear above */
}

.video-player__poster {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  z-index: 0;
  /* Position below video */
  opacity: 1;
  /* Start fully visible */
  transition: opacity 0.8s ease;
  /* Longer transition for a noticeable fade */
  will-change: opacity;
  /* Optimize for transitions */
}

/* Fade out poster when video is loaded */
.video-player.video-loaded .video-player__poster {
  opacity: 0 !important;
  /* Force opacity to 0 with !important to override any inline styles */
}

.video-player__overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: background-color 0.2s ease;
  /* Faster transition */
  cursor: pointer;
  contain: content;
  /* Add CSS containment for better performance */
  z-index: 3; /* Higher z-index to ensure it's above the video */
  pointer-events: auto; /* Make sure clicks are registered */
}

.video-player__overlay:hover {
  background-color: rgba(0, 0, 0, 0.25);
}

.video-player__play-button {
  width: 5rem;
  height: 5rem;
  background-color: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: transform 0.2s ease, background-color 0.2s ease;
  /* Faster transitions */
  z-index: 4; /* Higher z-index to ensure it's above the overlay */
  will-change: transform;
  /* Optimize button animations */
  pointer-events: auto; /* Make sure clicks are registered */
}

/* Animation applies both when hovering over the button itself */
.video-player__play-button:hover,
/* And when hovering over the entire overlay */
.video-player__overlay:hover .video-player__play-button {
  transform: scale(1.1);
  background-color: rgba(0, 0, 0, 0.8);
}

.video-player__play-icon {
  width: 0;
  height: 0;
  border-style: solid;
  border-width: .9375rem 0 .9375rem 1.5625rem;
  border-color: transparent transparent transparent white;
  margin-left: .3125rem;
}

/* Responsive Media Queries */
@media screen and (max-width: 48rem) {
  video-player {
    min-height: 8.75rem;
  }

  .video-player__play-button {
    width: 3.75rem;
    height: 3.75rem;
  }

  .video-player__play-icon {
    border-width: .75rem 0 .75rem 1.25rem;
    margin-left: .25rem;
  }
}

@media screen and (max-width: 30rem) {
  video-player {
    min-height: 7.5rem;
  }

  .video-player__play-button {
    width: 3.125rem;
    height: 3.125rem;
  }

  .video-player__play-icon {
    border-width: .625rem 0 .625rem 1rem;
    margin-left: .1875rem;
  }
}

/* Performance mode styles */
video-player.performance-mode .video-player__background {
  /* Reduce animation complexity */
  will-change: auto;
  /* Disable GPU acceleration hints */
  transform: translate(-50%, -50%) scale(1.05);
  /* Less scaling for better performance */
  transform-origin: center center;
  filter: none;
  /* Ensure no filters are applied */
  transition: none;
  /* Disable transitions completely */
}

/* Optimize rendering in performance mode */
video-player.performance-mode {
  transform: translateZ(0);
  /* Force GPU acceleration */
  background-color: #000;
  /* Darker background to hide potential artifacts */
  contain: strict;
  /* Maximum containment for best performance */
}

/* Mobile optimizations */
@media screen and (max-width: 47.9375rem) {
  .video-player__background {
    transform: translate(-50%, -50%) scale(1.1);
    /* Less scaling on mobile */
    transform-origin: center center;
  }

  video-player.performance-mode .video-player__background {
    transform: translate(-50%, -50%) scale(1.0);
    /* No scaling in performance mode */
    transform-origin: center center;
  }

  video-player {
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  /* Simplify animations on mobile */
  .video-player__overlay,
  .video-player__play-button {
    transition-duration: 0.1s;
  }
}

/* Video paused state */
video-player.video-paused .video-player__background {
  opacity: 0.4;
}

video-player.video-paused::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 2.5rem;
  height: 2.5rem;
  background-color: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  z-index: 2;
  opacity: 0;
  transition: opacity 0.2s ease;
  /* Faster transition */
}

video-player.video-paused:hover::after {
  opacity: 1;
}

/* Play icon when paused */
video-player.video-paused:hover::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 0;
  height: 0;
  border-style: solid;
  border-width: .625rem 0 .625rem 1rem;
  border-color: transparent transparent transparent white;
  margin-left: .125rem;
  z-index: 3;
}

/* Optimize for reduced motion and performance */
@media (prefers-reduced-motion: reduce) {
  .video-player__background,
  .video-player__play-button,
  .video-player__overlay,
  video-player.video-paused::after,
  .video-player__poster,
  .video-player.video-loaded {
    transition: none !important;
    animation: none !important;
  }

  /* Show content immediately */
  .video-player__background,
  .video-player__background.loaded {
    opacity: 1;
  }

  .video-player.video-loaded .video-player__poster {
    opacity: 0;
  }
}

/* Force hardware acceleration on mobile */
@media screen and (max-width: 47.9375rem) {
  video-player {
    transform: translateZ(0);
    backface-visibility: hidden;
    contain: strict;
  }
}

/* Add support for low data mode */
@media (prefers-reduced-data: reduce) {
  video-player.performance-mode .video-player__background,
  .video-player__background {
    transform: translate(-50%, -50%) scale(1.0);
    transform-origin: center center;
    /* No scaling in data saver mode */
  }
}

/* Layer compositing optimization - isolate animated elements */
.video-player__background,
.video-player__play-button,
.video-player__overlay {
  transform: translateZ(0);
}

/* Prefers-reduced-motion query */
@media (prefers-reduced-motion: reduce) {
  .video-player__background,
  .video-player__play-button,
  .video-player__overlay {
    transition: none !important;
    animation: none !important;
    transform: translate(-50%, -50%) scale(1.0) !important;
    transform-origin: center center !important;
  }
}

/* Make sure the video-loaded state doesn't hide the overlay */
.video-player.video-loaded .video-player__overlay,
.video-player.video-loaded .video-player__play-button {
  z-index: 3;
  pointer-events: auto;
}

.video-player.video-loaded .video-player__play-button {
  z-index: 4;
}

/* Make sure any media queries don't override our z-index settings */
@media (prefers-reduced-motion: reduce) {
  .video-player__overlay,
  .video-player__play-button {
    z-index: 3 !important;
  }
  
  .video-player__play-button {
    z-index: 4 !important;
  }
  
  .video-player__background,
  .video-player__background-wrapper {
    z-index: 1 !important;
  }
}